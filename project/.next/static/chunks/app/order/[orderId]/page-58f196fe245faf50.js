(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{1286:function(e,t,s){Promise.resolve().then(s.bind(s,2802))},2802:function(e,t,s){"use strict";s.d(t,{default:function(){return f}});var a=s(7437),i=s(2265),l=s(5800),n=s(7586),c=s(3145),r=s(401);let o=(0,s(9763).Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);var d=s(6337),m=s(2735),x=s(2489),u=s(8933);async function h(e,t){let{error:s}=await u.O.from("orders").update({payment_status:t}).eq("id",e);if(s)throw s}var p=s(9852),b=s(6595);function y(e){let{isOpen:t,onClose:s,onSubmit:c,onSkip:r}=e,[o,d]=(0,i.useState)(0),[m,u]=(0,i.useState)(0),[h,p]=(0,i.useState)("");return(0,a.jsx)(n.M,{children:t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:s}),(0,a.jsx)(l.E.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-8 relative",children:[(0,a.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(x.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Rate Your Experience"}),(0,a.jsx)("p",{className:"text-gray-600",children:"How was your portrait redemption experience?"})]}),(0,a.jsx)("div",{className:"flex justify-center gap-2 mb-8",children:[1,2,3,4,5].map(e=>(0,a.jsx)("button",{onMouseEnter:()=>u(e),onMouseLeave:()=>u(0),onClick:()=>d(e),className:"transition-transform hover:scale-110",children:(0,a.jsx)(b.Z,{className:"w-12 h-12 ".concat(e<=(m||o)?"fill-amber-400 text-amber-400":"text-gray-300"," transition-colors")})},e))}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Feedback (Optional)"}),(0,a.jsx)("textarea",{value:h,onChange:e=>p(e.target.value),placeholder:"Tell us more about your experience...",rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>{r(),d(0),p("")},className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Skip"}),(0,a.jsx)("button",{onClick:()=>{o>0&&(c(o,h),d(0),p(""))},disabled:0===o,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-blue-500/30",children:"Submit Review"})]})]})})]})})}var g=s(2252);function j(e){let{isOpen:t,onClose:s,onSubmit:c}=e,[r,o]=(0,i.useState)("");return(0,a.jsx)(n.M,{children:t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:s}),(0,a.jsx)(l.E.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-8 relative",children:[(0,a.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(x.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"flex items-start gap-4 mb-6",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(g.Z,{className:"w-6 h-6 text-amber-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Request a Revision"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Let us know what changes you'd like to see in your portrait. Our team will review your request and get back to you soon."})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What would you like us to revise?"}),(0,a.jsx)("textarea",{value:r,onChange:e=>o(e.target.value),placeholder:"Please be as specific as possible about the changes you'd like...",rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:s,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{r.trim()&&(c(r),o(""))},disabled:!r.trim(),className:"flex-1 px-6 py-3 bg-gradient-to-r from-amber-600 to-amber-700 text-white rounded-lg hover:from-amber-700 hover:to-amber-800 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-amber-500/30",children:"Submit Request"})]})]})})]})})}function f(e){var t;let{order:s,primaryImages:u,upsellImages:b}=e,[g,f]=(0,i.useState)((null===(t=u.find(e=>e.is_selected))||void 0===t?void 0:t.id)||null),[v,N]=(0,i.useState)(u.some(e=>e.is_selected)),[w,k]=(0,i.useState)(!1),[C,z]=(0,i.useState)("paid"===s.payment_status),[E,S]=(0,i.useState)(!1),[O,P]=(0,i.useState)(!1),[_,D]=(0,i.useState)(!1),[T,Z]=(0,i.useState)(""),[R,q]=(0,i.useState)(!1),[M,F]=(0,i.useState)(!1),L=e=>{v||(f(e),k(!0))},A=async()=>{if(g)try{if(!(await fetch("/api/customer/".concat(s.id,"/confirm"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({selectedImageId:g,printProduct:s.product_type||"poster",notes:""})})).ok)throw Error("Failed to confirm order");(_||T)&&await fetch("/api/orders/".concat(s.id,"/social"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({social_consent:_,social_handle:T||null})}),new p.Z().addConfetti({emojis:["\uD83D\uDC36","\uD83D\uDC31","\uD83E\uDDB4","\uD83D\uDC3E"],confettiNumber:100}),N(!0),k(!1),setTimeout(()=>{q(!0)},1e3)}catch(e){console.error("Confirmation error:",e),alert("Failed to confirm selection. Please try again.")}},Y=async()=>{P(!0),setTimeout(async()=>{try{await h(s.id,"paid"),z(!0),S(!1)}catch(e){alert("Payment failed. Please try again.")}finally{P(!1)}},2e3)},I=async e=>{let t=await fetch(e.url),s=await t.blob(),a=window.URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download="image-".concat(e.id,".jpg"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(a)},U=async(e,t)=>{try{await fetch("/api/orders/".concat(s.id,"/review"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:e,review_text:t})}),q(!1),setTimeout(()=>{var e;null===(e=document.getElementById("upsell-section"))||void 0===e||e.scrollIntoView({behavior:"smooth"})},300)}catch(e){alert("Failed to submit review. Please try again.")}},B=async e=>{try{await fetch("/api/orders/".concat(s.id,"/revision"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({revision_notes:e,revision_status:"requested"})}),F(!1),alert("Revision request submitted! Our team will review it shortly.")}catch(e){alert("Failed to submit revision request. Please try again.")}},H=u.find(e=>e.id===g);return(0,a.jsxs)("div",{className:"min-h-screen px-4 py-12",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-16",children:[(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsxs)("h1",{children:["Welcome, ",s.customer_name,"!"]}),(0,a.jsxs)("p",{className:"text-zinc-400 text-lg",children:["Your ",s.product_type," is ready"]})]}),(0,a.jsxs)("section",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("h2",{children:"Choose Your Print"}),(0,a.jsx)("p",{className:"text-zinc-400",children:"Select the image you'd like to receive"})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:u.map(e=>(0,a.jsxs)(l.E.div,{whileHover:{y:v?0:-8},onClick:()=>L(e.id),className:"relative aspect-square rounded-lg overflow-hidden cursor-pointer transition-all ".concat(g===e.id?"ring-4 ring-[#7C3AED]":v?"opacity-50 cursor-not-allowed":"hover:ring-2 ring-zinc-700"),children:[(0,a.jsx)(c.default,{src:e.url,alt:"Option",fill:!0,className:"object-cover"}),g===e.id&&(0,a.jsx)("div",{className:"absolute inset-0 bg-[#7C3AED]/20 flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-12 h-12 bg-[#7C3AED] rounded-full flex items-center justify-center",children:(0,a.jsx)(r.Z,{className:"w-6 h-6 text-white"})})})]},e.id))}),g&&!v&&(0,a.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:(0,a.jsx)("button",{onClick:A,className:"btn-primary rounded-lg",children:"Confirm This Print"})}),v&&(0,a.jsxs)(l.E.div,{initial:{opacity:0},animate:{opacity:1},className:"glass-card p-6 rounded-lg text-center space-y-2",children:[(0,a.jsx)(r.Z,{className:"w-12 h-12 mx-auto text-green-400"}),(0,a.jsx)("p",{className:"text-zinc-300",children:"Your selection has been confirmed! Scroll down for bonus images."})]}),v&&(0,a.jsx)(l.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-center",children:(0,a.jsxs)("button",{onClick:()=>F(!0),className:"inline-flex items-center gap-2 text-sm text-zinc-400 hover:text-zinc-200 transition-colors",children:[(0,a.jsx)(o,{className:"w-4 h-4"}),"Need changes? Request a revision"]})})]}),(0,a.jsxs)("section",{id:"upsell-section",className:"space-y-8",children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("h2",{children:"Unlock Bonus Collection"}),(0,a.jsxs)("p",{className:"text-zinc-400",children:["Get all ",b.length," additional images for just $9"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:b.map(e=>(0,a.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden group",children:[(0,a.jsx)(c.default,{src:e.url,alt:"Bonus",fill:!0,className:"object-cover transition-all ".concat(C?"":"blur-sm grayscale")}),!C&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"w-8 h-8 text-zinc-400"})}),C&&(0,a.jsx)("button",{onClick:()=>I(e),className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"w-8 h-8 text-white"})}),!C&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,a.jsx)("div",{className:"text-white/40 text-6xl font-bold transform -rotate-12",children:"LOCKED"})})]},e.id))}),C?(0,a.jsxs)(l.E.div,{initial:{opacity:0},animate:{opacity:1},className:"glass-card p-6 rounded-lg text-center space-y-2",children:[(0,a.jsx)(r.Z,{className:"w-12 h-12 mx-auto text-green-400"}),(0,a.jsx)("p",{className:"text-zinc-300",children:"All images unlocked! Click any image to download."})]}):(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("button",{onClick:()=>S(!0),className:"btn-primary rounded-lg text-lg px-8 py-4",children:["Unlock All ",b.length," Images for $9"]})})]})]}),(0,a.jsxs)(n.M,{children:[w&&H&&(0,a.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:()=>k(!1),children:(0,a.jsxs)(l.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"relative max-w-5xl w-full",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{onClick:()=>k(!1),className:"absolute top-4 right-4 w-12 h-12 bg-zinc-900/90 rounded-full flex items-center justify-center z-10 hover:bg-zinc-800 transition-colors",children:(0,a.jsx)(x.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{className:"relative w-full aspect-[16/10] rounded-lg overflow-hidden",children:[(0,a.jsx)(c.default,{src:"https://images.pexels.com/photos/1648776/pexels-photo-1648776.jpeg?auto=compress&cs=tinysrgb&w=1920",alt:"Living Room",fill:!0,className:"object-cover"}),(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[35%] aspect-square shadow-2xl",children:(0,a.jsx)(c.default,{src:H.url,alt:"Your print",fill:!0,className:"object-cover"})})]}),(0,a.jsxs)("div",{className:"text-center mt-6 space-y-6",children:[(0,a.jsx)("p",{className:"text-xl text-zinc-100",children:"How it looks on your wall"}),(0,a.jsxs)("div",{className:"bg-zinc-900/50 rounded-lg p-6 space-y-4 text-left max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("input",{type:"checkbox",id:"socialConsent",checked:_,onChange:e=>D(e.target.checked),className:"mt-1 w-5 h-5 rounded border-zinc-700 text-[#7C3AED] focus:ring-[#7C3AED]"}),(0,a.jsx)("label",{htmlFor:"socialConsent",className:"text-sm text-zinc-300 cursor-pointer",children:"Can we feature your pet on social media? We'd love to share your beautiful portrait with our community!"})]}),_&&(0,a.jsxs)(l.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"socialHandle",className:"block text-sm text-zinc-300",children:"Instagram Handle (Optional)"}),(0,a.jsx)("input",{type:"text",id:"socialHandle",value:T,onChange:e=>Z(e.target.value),placeholder:"@yourhandle",className:"w-full px-4 py-2 bg-zinc-900/80 border border-zinc-800 rounded-lg text-zinc-100 placeholder:text-zinc-600 focus:ring-2 focus:ring-[#7C3AED] focus:border-transparent"})]})]}),(0,a.jsx)("button",{onClick:A,className:"btn-primary rounded-lg",children:"Confirm This Print"})]})]})}),E&&(0,a.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:()=>!O&&S(!1),children:(0,a.jsxs)(l.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card p-8 rounded-lg max-w-md w-full space-y-6",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("h2",{children:"Complete Purchase"}),(0,a.jsxs)("p",{className:"text-zinc-400",children:["Unlock all ",b.length," bonus images"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-zinc-300 mb-2",children:"Name on Card"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-3 bg-zinc-900/80 border border-zinc-800 rounded-lg text-zinc-100",placeholder:"John Doe"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-zinc-300 mb-2",children:"Card Number"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-3 bg-zinc-900/80 border border-zinc-800 rounded-lg text-zinc-100",placeholder:"4242 4242 4242 4242"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-zinc-300 mb-2",children:"Expiry"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-3 bg-zinc-900/80 border border-zinc-800 rounded-lg text-zinc-100",placeholder:"MM/YY"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-zinc-300 mb-2",children:"CVC"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-3 bg-zinc-900/80 border border-zinc-800 rounded-lg text-zinc-100",placeholder:"123"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{onClick:()=>S(!1),disabled:O,className:"btn-secondary rounded-lg flex-1 disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:Y,disabled:O,className:"btn-primary rounded-lg flex-1 disabled:opacity-50",children:O?"Processing...":"Pay $9"})]})]})})]}),(0,a.jsx)(y,{isOpen:R,onClose:()=>q(!1),onSubmit:U,onSkip:()=>{q(!1),setTimeout(()=>{var e;null===(e=document.getElementById("upsell-section"))||void 0===e||e.scrollIntoView({behavior:"smooth"})},300)}}),(0,a.jsx)(j,{isOpen:M,onClose:()=>F(!1),onSubmit:B})]})}},8933:function(e,t,s){"use strict";s.d(t,{O:function(){return a},e:function(){return i}});let a=(0,s(8439).eI)("https://opxgicxdrbpgpsxonogk.supabase.co","sb_publishable_oy3hhF4k8MiMOpfOBiCxOw_8nvsY8i2"),i=()=>a}},function(e){e.O(0,[799,145,439,925,971,117,744],function(){return e(e.s=1286)}),_N_E=e.O()}]);