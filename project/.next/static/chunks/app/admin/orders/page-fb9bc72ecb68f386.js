(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[606],{1293:function(e,t,r){Promise.resolve().then(r.bind(r,7613))},9763:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(2265),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),c=(e,t)=>{let r=(0,n.forwardRef)((r,c)=>{let{color:a="currentColor",size:l=24,strokeWidth:o=2,absoluteStrokeWidth:d,className:u="",children:x,...m}=r;return(0,n.createElement)("svg",{ref:c,...i,width:l,height:l,stroke:a,strokeWidth:d?24*Number(o)/Number(l):o,className:["lucide","lucide-".concat(s(e)),u].join(" "),...m},[...t.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(x)?x:[x]])});return r.displayName="".concat(e),r}},2252:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6901:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},9801:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]])},3468:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]])},5863:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2636:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]])},3247:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},257:function(e,t,r){"use strict";var n,i;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(i=r.g.process)?void 0:i.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,n,i=e.exports={};function s(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{r="function"==typeof clearTimeout?clearTimeout:c}catch(e){r=c}}();var l=[],o=!1,d=-1;function u(){o&&n&&(o=!1,n.length?l=n.concat(l):d=-1,l.length&&x())}function x(){if(!o){var e=a(u);o=!0;for(var t=l.length;t;){for(n=l,l=[];++d<t;)n&&n[d].run();d=-1,t=l.length}n=null,o=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new m(e,t)),1!==l.length||o||a(x)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var s=r[e]={exports:{}},c=!0;try{t[e](s,s.exports,n),c=!1}finally{c&&delete r[e]}return s.exports}n.ab="//";var i=n(229);e.exports=i}()},7613:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r(7437),i=r(2265),s=r(8933),c=r(9376),a=r(6424),l=r(3468),o=r(9801),d=r(2636),u=r(6901),x=r(3247),m=r(5863),h=r(2252);function f(){let[e,t]=(0,i.useState)([]),[r,f]=(0,i.useState)("all"),[g,v]=(0,i.useState)(new Set),[y,z]=(0,i.useState)(!0),[N,j]=(0,i.useState)(""),[w,k]=(0,i.useState)(1),[C,T]=(0,i.useState)(0),[A,Z]=(0,i.useState)(0),[S,E]=(0,i.useState)({all:0,inbox:0,revising:0,fulfilled:0,archived:0}),_=(0,c.useRouter)(),M=(0,s.e)(),O=()=>Z(e=>e+1);(0,i.useEffect)(()=>{(async()=>{let e=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=M.from("orders").select("*",{count:"exact",head:!0});e&&(r=r.eq("status",e)),t&&(r=r.neq("status","failed"));let{count:n}=await r;return n||0},[t,r,n,i,s]=await Promise.all([e(void 0,!0),e("pending"),e("revising"),e("fulfilled"),e("failed")]);E({all:t,inbox:r,revising:n,fulfilled:i,archived:s})})()},[e,A]),(0,i.useEffect)(()=>{let e=async()=>{z(!0);let e=M.from("orders").select("*",{count:"exact"});e="inbox"===r?e.eq("status","pending"):"revising"===r?e.eq("status","revising"):"fulfilled"===r?e.eq("status","fulfilled"):"archived"===r?e.eq("status","failed"):e.neq("status","failed"),N&&(e=e.or("customer_name.ilike.%".concat(N,"%,customer_email.ilike.%").concat(N,"%,pet_name.ilike.%").concat(N,"%")));let n=(w-1)*20,{data:i,count:s,error:c}=await e.order("created_at",{ascending:!1}).range(n,n+20-1);i&&t(i),null!==s&&T(s),c&&console.error("Error fetching orders:",c),z(!1)},n=setTimeout(()=>e(),300);return()=>clearTimeout(n)},[M,r,N,w,A]);let L=e=>{let t=new Set(g);t.has(e)?t.delete(e):t.add(e),v(t)},q=async(e,t)=>{if(t.stopPropagation(),!confirm("Archive this order?"))return;let{error:r}=await M.from("orders").update({status:"failed"}).eq("id",e);r?(console.error("Error archiving:",r),alert("Failed to archive order")):O()},P=async e=>{if("delete"===e){if(!confirm("Are you sure you want to PERMANENTLY DELETE ".concat(g.size," orders? This cannot be undone.")))return}else if(!confirm("Are you sure you want to ".concat(e," ").concat(g.size," orders?")))return;if(console.log("Executing ".concat(e," on"),Array.from(g)),"fulfill"===e){let{error:e}=await M.from("orders").update({status:"fulfilled"}).in("id",Array.from(g));e||(O(),v(new Set),alert("Orders marked as fulfilled!"))}else if("archive"===e){let{error:e}=await M.from("orders").update({status:"failed"}).in("id",Array.from(g));e||(O(),v(new Set),alert("Orders archived!"))}else if("delete"===e){let{error:e}=await M.from("orders").delete().in("id",Array.from(g));e?(console.error("Error deleting orders:",e),alert("Failed to delete orders. Check console for details.")):(O(),v(new Set),alert("Orders permanently deleted."))}else alert("".concat(e," action triggered (Not fully implemented yet)"))};return(0,n.jsxs)("div",{className:"min-h-screen px-4 py-8 max-w-7xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-zinc-100",children:"All Orders"}),(0,n.jsx)("p",{className:"text-zinc-500",children:"Manage, review, and fix customer orders"})]}),(0,n.jsx)("button",{onClick:()=>_.push("/admin/create"),className:"bg-zinc-800 hover:bg-zinc-700 text-zinc-200 px-4 py-2 rounded-lg transition-colors whitespace-nowrap",children:"+ New Order"})]}),(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[(0,n.jsxs)("div",{className:"flex p-1 bg-zinc-900/50 border border-zinc-800 rounded-lg overflow-x-auto no-scrollbar",children:[(0,n.jsx)(p,{active:"all"===r,onClick:()=>{f("all"),k(1)},icon:l.Z,label:"All Orders",count:S.all}),(0,n.jsx)(p,{active:"inbox"===r,onClick:()=>{f("inbox"),k(1)},icon:o.Z,label:"Inbox",count:S.inbox}),(0,n.jsx)(p,{active:"revising"===r,onClick:()=>{f("revising"),k(1)},icon:d.Z,label:"In Progress",count:S.revising}),(0,n.jsx)(p,{active:"fulfilled"===r,onClick:()=>{f("fulfilled"),k(1)},icon:u.Z,label:"Completed",count:S.fulfilled}),(0,n.jsx)(p,{active:"archived"===r,onClick:()=>{f("archived"),k(1)},icon:o.Z,label:"Archived",count:S.archived})]}),(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)(x.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500"}),(0,n.jsx)("input",{type:"text",placeholder:"Search by name, email, or pet...",value:N,onChange:e=>{j(e.target.value),k(1)},className:"w-full h-full bg-zinc-900 border border-zinc-800 rounded-lg pl-10 pr-4 py-2 text-zinc-200 focus:ring-2 focus:ring-amber-500 outline-none text-sm"})]})]}),y?(0,n.jsx)("div",{className:"flex justify-center py-12",children:(0,n.jsx)(m.Z,{className:"w-8 h-8 animate-spin text-amber-500"})}):0===e.length?(0,n.jsx)("div",{className:"text-center py-12 bg-zinc-900/50 rounded-lg border border-zinc-800",children:(0,n.jsx)("p",{className:"text-zinc-500",children:"No orders found."})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"bg-zinc-900/50 rounded-xl border border-zinc-800 overflow-hidden",children:(0,n.jsxs)("table",{className:"w-full text-left text-sm text-zinc-400",children:[(0,n.jsx)("thead",{className:"bg-zinc-900 text-zinc-200 uppercase tracking-wider text-xs",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"p-4 w-10",children:(0,n.jsx)("input",{type:"checkbox",checked:e.length>0&&g.size===e.length,onChange:()=>{g.size===e.length?v(new Set):v(new Set(e.map(e=>e.id)))},className:"rounded border-zinc-700 bg-zinc-800 text-amber-500 focus:ring-amber-500"})}),(0,n.jsx)("th",{className:"p-4 font-medium",children:"Date"}),(0,n.jsx)("th",{className:"p-4 font-medium",children:"Customer"}),(0,n.jsx)("th",{className:"p-4 font-medium",children:"Pet"}),(0,n.jsx)("th",{className:"p-4 font-medium",children:"Status"}),(0,n.jsx)("th",{className:"p-4 font-medium",children:"Action"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-zinc-800",children:e.map(e=>(0,n.jsxs)("tr",{className:"hover:bg-zinc-800/50 cursor-pointer transition-colors ".concat(g.has(e.id)?"bg-amber-500/5":""),onClick:t=>{"INPUT"!==t.target.tagName&&"BUTTON"!==t.target.tagName&&_.push("/admin/orders/".concat(e.id))},children:[(0,n.jsx)("td",{className:"p-4",children:(0,n.jsx)("input",{type:"checkbox",checked:g.has(e.id),onChange:()=>L(e.id),className:"rounded border-zinc-700 bg-zinc-800 text-amber-500 focus:ring-amber-500"})}),(0,n.jsxs)("td",{className:"p-4 whitespace-nowrap",children:[(0,a.WU)(new Date(e.created_at),"MMM d, yyyy"),(0,n.jsx)("div",{className:"text-xs text-zinc-600",children:(0,a.WU)(new Date(e.created_at),"h:mm a")})]}),(0,n.jsxs)("td",{className:"p-4",children:[(0,n.jsx)("div",{className:"font-medium text-zinc-200",children:e.customer_name}),(0,n.jsx)("div",{className:"text-xs",children:e.customer_email})]}),(0,n.jsxs)("td",{className:"p-4",children:[e.pet_name||(0,n.jsx)("span",{className:"text-zinc-600 italic",children:"No name"}),(0,n.jsx)("div",{className:"text-xs text-zinc-500",children:e.pet_breed})]}),(0,n.jsxs)("td",{className:"p-4",children:[(0,n.jsx)(b,{status:e.status}),e.customer_notes&&(0,n.jsxs)("div",{className:"flex items-center gap-1 text-amber-500 text-xs mt-1 font-bold",children:[(0,n.jsx)(h.Z,{className:"w-3 h-3"}),"Has Feedback"]})]}),(0,n.jsxs)("td",{className:"p-4 flex items-center gap-3",children:[(0,n.jsx)("span",{className:"text-amber-500 hover:text-amber-400 font-medium",children:"Manage â†’"}),"archived"!==r&&(0,n.jsx)("button",{onClick:t=>q(e.id,t),className:"text-zinc-600 hover:text-red-400 text-xs px-2 py-1 rounded bg-zinc-800/50 hover:bg-zinc-800 border border-zinc-700/50 transition-colors",title:"Archive Order",children:"Archive"})]})]},e.id))})]})}),(0,n.jsxs)("div",{className:"flex items-center justify-between mt-6 bg-zinc-900/50 p-4 rounded-lg border border-zinc-800",children:[(0,n.jsxs)("div",{className:"text-sm text-zinc-500",children:["Showing ",(0,n.jsx)("span",{className:"font-medium text-zinc-300",children:(w-1)*20+1})," to"," ",(0,n.jsx)("span",{className:"font-medium text-zinc-300",children:Math.min(20*w,C)})," of"," ",(0,n.jsx)("span",{className:"font-medium text-zinc-300",children:C})," results"]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>k(e=>Math.max(1,e-1)),disabled:1===w,className:"px-3 py-1 rounded bg-zinc-800 border border-zinc-700 text-zinc-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-zinc-700",children:"Previous"}),(0,n.jsx)("button",{onClick:()=>k(e=>e+1),disabled:20*w>=C,className:"px-3 py-1 rounded bg-zinc-800 border border-zinc-700 text-zinc-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-zinc-700",children:"Next"})]})]})]}),g.size>0&&(0,n.jsxs)("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 bg-zinc-800 border border-zinc-700 shadow-xl rounded-full px-6 py-3 flex items-center gap-4 z-50",children:[(0,n.jsxs)("span",{className:"text-zinc-300 font-medium text-sm",children:[g.size," selected"]}),(0,n.jsx)("div",{className:"h-4 w-px bg-zinc-700"}),(0,n.jsx)("button",{onClick:()=>P("fulfill"),className:"text-amber-500 hover:text-amber-400 font-medium text-sm",children:"Mark Fulfilled"}),(0,n.jsx)("button",{onClick:()=>P("email"),className:"text-zinc-400 hover:text-zinc-200 text-sm",children:"Send Email"}),(0,n.jsx)("button",{onClick:()=>P("archive"),className:"text-zinc-400 hover:text-red-400 text-sm",children:"Archive"}),(0,n.jsx)("button",{onClick:()=>P("delete"),className:"text-red-500 hover:text-red-400 text-sm font-medium ml-2",children:"Delete"}),(0,n.jsx)("button",{onClick:()=>v(new Set),className:"ml-2 text-zinc-500 hover:text-zinc-300",children:"Cancel"})]})]})}function p(e){let{active:t,onClick:r,icon:i,label:s,count:c}=e;return(0,n.jsxs)("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 rounded-md transition-colors text-sm font-medium whitespace-nowrap\n                ".concat(t?"bg-zinc-800 text-zinc-100 shadow-sm":"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800/50"),children:[(0,n.jsx)(i,{className:"w-4 h-4"}),s,c>0&&(0,n.jsx)("span",{className:"ml-1 px-1.5 py-0.5 rounded-full text-[10px] ".concat(t?"bg-zinc-700 text-zinc-200":"bg-zinc-800 text-zinc-500"),children:c})]})}function b(e){let{status:t}=e;return(0,n.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-bold border ".concat({pending:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",fulfilled:"bg-green-500/10 text-green-500 border-green-500/20",revising:"bg-rose-500/10 text-rose-500 border-rose-500/20",failed:"bg-zinc-800 text-zinc-500 border-zinc-700"}[t]||"bg-zinc-800 text-zinc-400 border-zinc-700"),children:"failed"===t?"Archived":t.charAt(0).toUpperCase()+t.slice(1)})}},8933:function(e,t,r){"use strict";r.d(t,{O:function(){return n},e:function(){return i}});let n=(0,r(8439).eI)("https://opxgicxdrbpgpsxonogk.supabase.co","sb_publishable_oy3hhF4k8MiMOpfOBiCxOw_8nvsY8i2"),i=()=>n}},function(e){e.O(0,[439,424,971,117,744],function(){return e(e.s=1293)}),_N_E=e.O()}]);