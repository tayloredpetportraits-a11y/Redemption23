(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[74],{5690:function(e,t,a){Promise.resolve().then(a.bind(a,822))},5302:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},8867:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},822:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return j}});var r=a(7437),s=a(2265),n=a(7586),l=a(5800),o=a(5725),c=a(9763);let i=(0,c.Z)("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),d=(0,c.Z)("FolderUp",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]]);var p=a(2489),u=a(7689),x=a(5302),m=a(8867),h=a(3145),b=a(9376);let g=(0,a(8439).eI)("https://opxgicxdrbpgpsxonogk.supabase.co","sb_publishable_oy3hhF4k8MiMOpfOBiCxOw_8nvsY8i2");function j(){let e=(0,b.useRouter)(),[t,a]=(0,s.useState)("generate"),[c,j]=(0,s.useState)(""),[v,f]=(0,s.useState)(""),[y,N]=(0,s.useState)("royalty"),[z,w]=(0,s.useState)("Canvas"),[k,C]=(0,s.useState)([]),[P,S]=(0,s.useState)([]),[O,M]=(0,s.useState)(""),[R,Z]=(0,s.useState)(""),[E,D]=(0,s.useState)(!1),[L,_]=(0,s.useState)([]),[A,I]=(0,s.useState)([]),[T,F]=(0,s.useState)(!1),[U,q]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{let{data:e}=await g.from("mockup_templates").select("id, name").eq("is_active",!0).order("name");e&&C(e)})()},[]);let V=(0,o.uI)({accept:{"image/*":[".png",".jpg",".jpeg",".webp"]},maxFiles:50,onDrop:e=>_(t=>[...t,...e])}),B=(0,o.uI)({accept:{"image/*":[".png",".jpg",".jpeg",".webp"]},maxFiles:50,onDrop:e=>I(t=>[...t,...e])}),G=(0,o.uI)({accept:{"image/*":[".png",".jpg",".jpeg",".webp"]},maxFiles:1,onDrop:e=>S(e)}),H=e=>{_(t=>t.filter((t,a)=>a!==e))},W=e=>{I(t=>t.filter((t,a)=>a!==e))},Y=async a=>{a.preventDefault(),F(!0);let r="".concat(y," ").concat(z).trim();try{if("generate"===t){if(0===P.length){alert("Please upload a pet photo"),F(!1);return}let t=new FormData;t.append("customerName",c),t.append("customerEmail",v),t.append("productType",r),t.append("petPhoto",P[0]),t.append("petBreed",O),t.append("petDetails",R),t.append("autoApprove",String(E));let a=await fetch("/api/orders/create",{method:"POST",body:t}),s=await a.json();if(!a.ok)throw Error(s.error);q({url:"".concat(window.location.origin,"/admin/review")}),setTimeout(()=>{e.push("/admin/review")},1500)}else{let e=new FormData;e.append("customerName",c),e.append("customerEmail",v),e.append("productType",r),L.forEach(t=>e.append("files",t)),A.forEach(t=>e.append("mockups",t));let t=await fetch("/api/orders/manual",{method:"POST",body:e}),a=await t.json();if(!t.ok)throw Error(a.error);q({url:"".concat(window.location.origin).concat(a.customerUrl)})}}catch(e){e instanceof Error?alert(e.message||"Error occurred"):alert("Error occurred")}finally{F(!1)}};return(0,r.jsx)("div",{className:"min-h-screen px-4 py-8 bg-zinc-950",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto space-y-8",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-zinc-100",children:"Create Order"}),(0,r.jsx)("p",{className:"text-zinc-400",children:"Choose how to fulfill this order"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 p-1 bg-zinc-900 rounded-xl border border-zinc-800",children:[(0,r.jsxs)("button",{onClick:()=>a("generate"),className:"flex items-center justify-center gap-2 py-3 rounded-lg text-sm font-medium transition-all ".concat("generate"===t?"bg-zinc-800 text-white shadow":"text-zinc-500 hover:text-zinc-300"),children:[(0,r.jsx)(i,{className:"w-4 h-4"}),"AI Generate"]}),(0,r.jsxs)("button",{onClick:()=>a("manual"),className:"flex items-center justify-center gap-2 py-3 rounded-lg text-sm font-medium transition-all ".concat("manual"===t?"bg-zinc-800 text-white shadow":"text-zinc-500 hover:text-zinc-300"),children:[(0,r.jsx)(d,{className:"w-4 h-4"}),"Manual Upload"]})]}),(0,r.jsxs)("form",{onSubmit:Y,className:"glass-card p-6 rounded-xl space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-zinc-500 mb-1 block",children:"Customer Name"}),(0,r.jsx)("input",{className:"w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-2 text-zinc-100 focus:border-amber-500 outline-none",value:c,onChange:e=>j(e.target.value),required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-zinc-500 mb-1 block",children:"Customer Email"}),(0,r.jsx)("input",{type:"email",className:"w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-2 text-zinc-100 focus:border-amber-500 outline-none",value:v,onChange:e=>f(e.target.value),required:!0})]})]}),"generate"===t?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-zinc-500 mb-1 block",children:"Art Theme"}),(0,r.jsxs)("select",{className:"w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-2 text-zinc-100 focus:border-amber-500 outline-none",value:y,onChange:e=>N(e.target.value),children:[(0,r.jsx)("option",{value:"royalty",children:"Royalty"}),(0,r.jsx)("option",{value:"spaday",children:"Spa Day"}),(0,r.jsx)("option",{value:"minimalist",children:"Minimalist"}),(0,r.jsx)("option",{value:"valentines",children:"Valentine's"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-zinc-500 mb-1 block",children:"Item / Template"}),(0,r.jsxs)("select",{className:"w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-2 text-zinc-100 focus:border-amber-500 outline-none",value:z,onChange:e=>w(e.target.value),children:[(0,r.jsx)("option",{value:"Canvas",children:"Default Canvas"}),(0,r.jsx)("option",{value:"Digital",children:"Digital Only"}),k.length>0&&(0,r.jsx)("option",{disabled:!0,children:"-- Custom Templates --"}),k.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,r.jsxs)("div",{className:"space-y-4 border-t border-zinc-800 pt-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-zinc-500 mb-1 block",children:"Pet Breed"}),(0,r.jsx)("input",{className:"w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-2 text-zinc-100 focus:border-amber-500 outline-none",value:O,onChange:e=>M(e.target.value),placeholder:"e.g. Golden Retriever"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-zinc-500 mb-1 block",children:"Unique Features (Identity Lock)"}),(0,r.jsx)("input",{className:"w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-2 text-zinc-100 focus:border-amber-500 outline-none",value:R,onChange:e=>Z(e.target.value),placeholder:"e.g. White spot on chest, missing left eye"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-zinc-500 mb-1 block",children:"Pet Photo"}),(0,r.jsxs)("div",{...G.getRootProps(),className:"border-2 border-dashed border-zinc-800 hover:border-amber-500 rounded-xl p-8 text-center cursor-pointer transition-colors",children:[(0,r.jsx)("input",{...G.getInputProps()}),P.length>0?(0,r.jsxs)("div",{className:"relative w-32 h-32 mx-auto",children:[(0,r.jsx)(h.default,{src:URL.createObjectURL(P[0]),alt:"Pet",fill:!0,className:"object-cover rounded-lg"}),(0,r.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),S([])},className:"absolute -top-2 -right-2 bg-red-500 rounded-full p-1",children:(0,r.jsx)(p.Z,{className:"w-4 h-4 text-white"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{className:"w-8 h-8 text-zinc-600 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:"Drag & drop dog photo here"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-zinc-900/50 rounded-lg border border-zinc-800 mt-4",children:[(0,r.jsx)("input",{type:"checkbox",id:"autoApprove",checked:E,onChange:e=>D(e.target.checked),className:"w-5 h-5 rounded border-zinc-700 bg-zinc-800 text-amber-500 focus:ring-amber-500 accent-amber-500"}),(0,r.jsx)("label",{htmlFor:"autoApprove",className:"text-sm text-zinc-300 cursor-pointer select-none font-medium",children:'Auto-Approve Results (Skip "Approve All")'})]})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-zinc-500 mb-1 block",children:"Product Type (Type manually for custom)"}),(0,r.jsx)("input",{className:"w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-2 text-zinc-100 focus:border-amber-500 outline-none",value:y,onChange:e=>N(e.target.value),placeholder:"e.g. Custom Portrait"})]}),(0,r.jsxs)("div",{...V.getRootProps(),className:"border-2 border-dashed border-zinc-800 hover:border-amber-500 rounded-xl p-8 text-center cursor-pointer transition-colors",children:[(0,r.jsx)("input",{...V.getInputProps()}),(0,r.jsx)(u.Z,{className:"w-8 h-8 text-zinc-600 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:"Drag & drop finished images here"}),(0,r.jsxs)("p",{className:"text-zinc-600 text-xs mt-1",children:[L.length," files selected"]})]}),L.length>0&&(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2",children:L.map((e,t)=>(0,r.jsxs)("div",{className:"aspect-square bg-zinc-900 rounded relative group overflow-hidden",children:[(0,r.jsx)(h.default,{src:URL.createObjectURL(e),alt:"preview",fill:!0,className:"object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>H(t),className:"absolute top-1 right-1 bg-red-500 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,r.jsx)(p.Z,{className:"w-3 h-3 text-white"})})]},t))}),(0,r.jsxs)("div",{className:"border-t border-zinc-800 my-4 pt-4",children:[(0,r.jsx)("label",{className:"text-xs text-zinc-500 mb-1 block",children:"Manual Mockups (Optional)"}),(0,r.jsxs)("div",{...B.getRootProps(),className:"border-2 border-dashed border-zinc-800 hover:border-blue-500 rounded-xl p-8 text-center cursor-pointer transition-colors bg-zinc-900/30",children:[(0,r.jsx)("input",{...B.getInputProps()}),(0,r.jsx)(u.Z,{className:"w-8 h-8 text-blue-500 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:"Drag & drop mockup images here"}),(0,r.jsxs)("p",{className:"text-zinc-600 text-xs mt-1",children:[A.length," files selected"]})]}),A.length>0&&(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 mt-4",children:A.map((e,t)=>(0,r.jsxs)("div",{className:"aspect-square bg-zinc-900 rounded relative group overflow-hidden border border-blue-500/30",children:[(0,r.jsx)(h.default,{src:URL.createObjectURL(e),alt:"mockup-preview",fill:!0,className:"object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>W(t),className:"absolute top-1 right-1 bg-red-500 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,r.jsx)(p.Z,{className:"w-3 h-3 text-white"})})]},t))})]})]}),(0,r.jsx)("button",{disabled:T,className:"w-full btn-primary py-3 rounded-lg font-bold",children:T?"Processing...":"generate"===t?"Start Generation":"Create & Approve Order"})]}),(0,r.jsx)(n.M,{children:U&&(0,r.jsxs)(l.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"glass-card p-6 rounded-xl border border-green-900/50 bg-green-900/10 text-center",children:[(0,r.jsx)(x.Z,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-bold text-green-400 mb-2",children:"Order Created!"}),"generate"===t?(0,r.jsx)("p",{className:"text-zinc-400 mb-4",children:"Images are generating now. Redirecting..."}):(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-black/40 p-2 rounded-lg mt-4",children:[(0,r.jsx)("input",{readOnly:!0,value:U.url,className:"bg-transparent flex-1 text-xs text-zinc-400 outline-none font-mono"}),(0,r.jsx)("button",{onClick:()=>navigator.clipboard.writeText(U.url),className:"p-2 hover:bg-white/10 rounded",children:(0,r.jsx)(m.Z,{className:"w-4 h-4 text-zinc-400"})})]}),(0,r.jsxs)("div",{className:"mt-4 flex gap-2 justify-center",children:[(0,r.jsx)("a",{href:U.url,target:"_blank",className:"btn-secondary px-4 py-2 rounded text-sm",children:"Open Link"}),(0,r.jsx)("button",{onClick:()=>{q(null),_([]),I([]),S([]),j("")},className:"btn-primary px-4 py-2 rounded text-sm",children:"New Order"})]})]})})]})})}}},function(e){e.O(0,[799,145,439,108,971,117,744],function(){return e(e.s=5690)}),_N_E=e.O()}]);