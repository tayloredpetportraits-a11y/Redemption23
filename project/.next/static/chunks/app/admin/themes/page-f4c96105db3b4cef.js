(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[518],{3776:function(e,t,a){Promise.resolve().then(a.bind(a,4241))},1473:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]])},5863:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3276:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},8930:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},4241:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(7437),i=a(2265),n=a(3145),r=a(2489),c=a(8930),l=a(7689),o=a(5863),d=a(1473),m=a(3276);let h=(0,a(9763).Z)("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var x=a(5725),u=a(5800),p=a(7586);function b(e){let{theme:t,type:a,onClose:l,onImageDeleted:o}=e,[d,m]=(0,i.useState)([]),[h,x]=(0,i.useState)(!0),p=(0,i.useCallback)(()=>{x(!0),fetch("/api/admin/themes/details?id=".concat(t.id,"&type=").concat(a)).then(e=>e.json()).then(e=>m(e.images||[])).catch(console.error).finally(()=>x(!1))},[t.id,a]);(0,i.useEffect)(()=>{p()},[p]);let b=async e=>{if(confirm("Delete this image?"))try{(await fetch("/api/admin/themes/images/delete",{method:"POST",body:JSON.stringify({themeId:t.id,filename:e,type:a})})).ok?(p(),o()):alert("Failed to delete image")}catch(e){console.error(e),alert("Error deleting image")}};return(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:(0,s.jsxs)(u.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 w-full max-w-4xl h-[80vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold text-zinc-100",children:["Manage ",t.name]}),(0,s.jsx)("button",{onClick:l,className:"p-2 hover:bg-zinc-800 rounded-lg text-zinc-400 hover:text-white",children:(0,s.jsx)(r.Z,{className:"w-5 h-5"})})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0 bg-zinc-950/50 rounded-lg p-4 border border-zinc-800/50",children:h?(0,s.jsx)("div",{className:"flex items-center justify-center h-full text-zinc-500",children:"Loading images..."}):0===d.length?(0,s.jsx)("div",{className:"flex items-center justify-center h-full text-zinc-500",children:"No images found. Upload some!"}):(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:d.map(e=>(0,s.jsxs)("div",{className:"group relative aspect-square bg-zinc-900 rounded-lg overflow-hidden border border-zinc-800",children:[(0,s.jsx)(n.default,{src:e.url,alt:e.name,fill:!0,className:"object-cover"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,s.jsx)("button",{onClick:()=>b(e.name),className:"p-2 bg-red-500/20 text-red-400 hover:bg-red-500 hover:text-white rounded-full transition-colors",title:"Delete Image",children:(0,s.jsx)(c.Z,{className:"w-5 h-5"})})}),(0,s.jsx)("div",{className:"absolute bottom-0 inset-x-0 p-2 bg-black/80 text-[10px] text-zinc-400 truncate",children:e.name})]},e.name))})})]})})}function f(e){let{theme:t,onTest:a,onUpload:r,onDelete:h,onManage:b}=e,[f,g]=(0,i.useState)(!1),j=(0,i.useCallback)(async e=>{e.length>0&&(g(!0),await r(t.id,e),g(!1))},[t.id,r]),{getRootProps:y,getInputProps:N,isDragActive:v}=(0,x.uI)({onDrop:j,onDropRejected:e=>{let t=e.map(e=>"".concat(e.file.name,": ").concat(e.errors.map(e=>e.message).join(", "))).join("\n");alert("Files rejected:\n".concat(t))},noClick:!1,accept:{"image/*":[".jpg",".jpeg",".png",".webp"]}});return(0,s.jsxs)("div",{className:"relative bg-zinc-900 rounded-xl overflow-hidden border border-zinc-800 hover:border-zinc-700 transition-all group",children:[(0,s.jsxs)("div",{className:"aspect-square relative bg-zinc-950",children:[(0,s.jsxs)("div",{...y(),className:"absolute inset-0 z-10 cursor-pointer ".concat(v?"ring-2 ring-amber-500/50":""),children:[(0,s.jsx)("input",{...N()}),t.previewImage?(0,s.jsx)(n.default,{src:t.previewImage,alt:t.name,fill:!0,className:"object-cover opacity-80 group-hover:opacity-100 transition-opacity"}):(0,s.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-zinc-700 gap-2",children:[(0,s.jsx)(l.Z,{className:"w-8 h-8 opacity-20"}),(0,s.jsx)("span",{className:"text-xs",children:"Drop images to start"})]}),(0,s.jsx)(p.M,{children:(v||f)&&(0,s.jsx)(u.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-30 bg-black/80 flex flex-col items-center justify-center p-4 text-center backdrop-blur-sm",children:f?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{className:"w-8 h-8 text-amber-500 animate-spin mb-2"}),(0,s.jsx)("span",{className:"text-amber-500 font-bold",children:"Uploading..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Z,{className:"w-10 h-10 text-amber-500 mb-2"}),(0,s.jsx)("span",{className:"text-zinc-200 font-bold",children:"Drop Images Here"}),(0,s.jsxs)("span",{className:"text-zinc-500 text-xs",children:["to add to ",t.name]})]})})})]}),(0,s.jsxs)("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-black/60 rounded text-xs text-white font-mono backdrop-blur-sm z-20 pointer-events-none",children:[t.imageCount," items"]}),(0,s.jsxs)("div",{className:"absolute top-2 right-2 flex gap-1 z-20",children:[(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),h(t.id)},className:"p-1.5 bg-black/60 hover:bg-red-500/80 hover:text-white rounded text-zinc-400 backdrop-blur-sm transition-colors shadow-lg",title:"Delete Theme",children:(0,s.jsx)(c.Z,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),b(t)},className:"p-1.5 bg-black/60 hover:bg-zinc-700 hover:text-white rounded text-zinc-200 backdrop-blur-sm transition-colors shadow-lg",title:"Manage Images",children:(0,s.jsx)(d.Z,{className:"w-3.5 h-3.5"})})]})]}),(0,s.jsxs)("div",{className:"p-4 relative z-20 bg-zinc-900",children:[(0,s.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-zinc-200",children:t.name}),(0,s.jsxs)("p",{className:"text-xs text-zinc-500",children:["ID: ",t.id]})]})}),(0,s.jsxs)("button",{onClick:()=>a(t.id),className:"w-full py-2 bg-zinc-800 hover:bg-zinc-700 text-zinc-200 text-sm rounded-lg flex items-center justify-center gap-2 transition-colors",children:[(0,s.jsx)(m.Z,{className:"w-3 h-3"})," Test Order"]})]})]})}function g(){let[e,t]=(0,i.useState)("portrait"),[a,n]=(0,i.useState)([]),[r,c]=(0,i.useState)(!0),[l,o]=(0,i.useState)(null),[d,m]=(0,i.useState)(!1),[x,g]=(0,i.useState)(null),[j,y]=(0,i.useState)(""),N=(0,i.useCallback)(()=>{c(!0),fetch("portrait"===e?"/api/admin/themes":"/api/admin/mockup-themes").then(e=>e.json()).then(e=>n(e.themes)).catch(e=>console.error("Failed to load themes:",e)).finally(()=>c(!1))},[e]);(0,i.useEffect)(()=>{N()},[N]);let v=async t=>{if("mockup"!==e){o(t);try{await fetch("/api/admin/seed",{method:"POST",body:JSON.stringify({theme:t})}),window.location.href="/admin/review"}catch(e){console.error(e),alert("Failed to start test")}finally{o(null)}}},k=async(t,a)=>{let s=new FormData;s.append("themeId",t),a.forEach(e=>s.append("files",e));let i="portrait"===e?"/api/admin/themes/upload":"/api/admin/mockup-themes/upload";console.log("Uploading to ".concat(i," for theme ").concat(t));try{let e=await fetch(i,{method:"POST",body:s});if(e.ok)N(),alert("Upload Successful: ".concat(a.length," files"));else{let t=await e.text();console.error("Upload failed response:",t),alert("Upload failed: ".concat(e.status," ").concat(e.statusText,"\n").concat(t))}}catch(e){console.error(e),alert("Upload error: ".concat(e))}},z=async t=>{if(confirm("Are you sure you want to delete this theme? This action cannot be undone."))try{(await fetch("/api/admin/themes/delete",{method:"POST",body:JSON.stringify({themeId:t,type:e})})).ok?N():alert("Failed to delete theme")}catch(e){console.error(e),alert("Error deleting theme")}},w=async t=>{t.preventDefault();let a="portrait"===e?"/api/admin/themes/create":"/api/admin/mockup-themes/create";try{let e=await fetch(a,{method:"POST",body:JSON.stringify({name:j})});if(e.ok)y(""),m(!1),N();else{let t=await e.json();alert(t.error||"Failed to create")}}catch(e){console.error(e),alert("Error creating theme")}};return r&&0===a.length?(0,s.jsx)("div",{className:"p-8 text-zinc-400",children:"Loading themes..."}):(0,s.jsxs)("div",{className:"min-h-screen bg-zinc-950 p-8",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-zinc-100 mb-1",children:"Theme Library"}),(0,s.jsx)("p",{className:"text-zinc-500 text-sm",children:"Manage your portrait styles and product mockups."})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"bg-zinc-900 p-1 rounded-lg flex border border-zinc-800",children:[(0,s.jsx)("button",{onClick:()=>t("portrait"),className:"px-4 py-1.5 text-sm font-medium rounded-md transition-all ".concat("portrait"===e?"bg-zinc-800 text-zinc-100 shadow-sm":"text-zinc-400 hover:text-zinc-200"),children:"Portraits"}),(0,s.jsx)("button",{onClick:()=>t("mockup"),className:"px-4 py-1.5 text-sm font-medium rounded-md transition-all ".concat("mockup"===e?"bg-amber-900/40 text-amber-200 shadow-sm":"text-zinc-400 hover:text-zinc-200"),children:"Mockups"})]}),(0,s.jsxs)("button",{onClick:()=>m(!0),className:"btn-primary flex items-center gap-2 px-4 py-2 rounded-lg",children:[(0,s.jsx)(h,{className:"w-4 h-4"}),"New ","portrait"===e?"Theme":"Product"]})]})]}),(0,s.jsx)("div",{className:"mb-6",children:"mockup"===e&&(0,s.jsxs)("div",{className:"bg-amber-900/10 border border-amber-500/20 text-amber-200 px-4 py-3 rounded-lg text-sm flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"}),"Upload your blank product images (T-Shirts, Mugs, etc) here to use them in Nano Banana Pro."]})}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:a.map(e=>(0,s.jsx)(f,{theme:e,onTest:v,onUpload:k,onDelete:z,onManage:g},e.id))}),0===a.length&&!r&&(0,s.jsxs)("div",{className:"text-center py-20 border-2 border-dashed border-zinc-800 rounded-2xl",children:[(0,s.jsxs)("p",{className:"text-zinc-500 mb-2",children:["No ",e," themes found."]}),(0,s.jsxs)("button",{onClick:()=>m(!0),className:"text-amber-500 hover:underline",children:["Create your first ","portrait"===e?"theme":"mockup product"]})]}),(0,s.jsxs)(p.M,{children:[d&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:(0,s.jsxs)(u.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 w-full max-w-sm",children:[(0,s.jsxs)("h2",{className:"text-lg font-bold text-zinc-100 mb-4",children:["Create New ","portrait"===e?"Theme":"Mockup Product"]}),(0,s.jsxs)("form",{onSubmit:w,children:[(0,s.jsx)("input",{autoFocus:!0,className:"w-full bg-zinc-950 border border-zinc-800 rounded px-3 py-2 text-zinc-100 mb-4 focus:border-amber-500 outline-none",placeholder:"portrait"===e?"Theme Name (e.g. Superhero)":"Product Name (e.g. White T-Shirt)",value:j,onChange:e=>y(e.target.value)}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 text-zinc-400 hover:text-zinc-100",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:!j.trim(),className:"btn-primary px-4 py-2 rounded",children:"Create"})]})]})]})}),x&&(0,s.jsx)(b,{theme:x,type:e,onClose:()=>g(null),onImageDeleted:N})]})]})}}},function(e){e.O(0,[799,145,108,971,117,744],function(){return e(e.s=3776)}),_N_E=e.O()}]);