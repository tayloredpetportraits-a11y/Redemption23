"use strict";(()=>{var e={};e.id=2745,e.ids=[2745],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},47726:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>d});var a={};r.r(a),r.d(a,{POST:()=>l});var o=r(49303),s=r(88716),i=r(60670),p=r(87070),u=r(65655),n=r(2390);async function l(e){try{let t=await e.formData(),r=t.get("file"),a=t.get("name"),o=t.get("keywords");if(!r||!a)return p.NextResponse.json({error:"Missing file or name"},{status:400});let s=Buffer.from(await r.arrayBuffer()),i=`templates/mockups/${Date.now()}_${r.name.replace(/[^a-z0-9.]/gi,"_")}`;await (0,n.uploadFile)(i,s,r.type);let l=(0,n.getPublicUrl)(i),c=(0,u.i)(),m=o?o.split(",").map(e=>e.trim()).filter(Boolean):[],{data:d,error:f}=await c.from("mockup_templates").insert({name:a,image_url:l,keywords:m,is_active:!0}).select().single();if(f)throw f;return p.NextResponse.json({success:!0,template:d})}catch(e){return console.error("Upload failed:",e),p.NextResponse.json({error:e.message},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/admin/mockups/templates/upload/route",pathname:"/api/admin/mockups/templates/upload",filename:"route",bundlePath:"app/api/admin/mockups/templates/upload/route"},resolvedPagePath:"/Users/taylorstrong/Redemption23-1/project/src/app/api/admin/mockups/templates/upload/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:d,serverHooks:f}=c,g="/api/admin/mockups/templates/upload/route";function x(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:d})}},65655:(e,t,r)=>{r.d(t,{i:()=>o});var a=r(69498);function o(){let e=process.env.SUPABASE_SERVICE_ROLE_KEY;return(0,a.eI)("https://opxgicxdrbpgpsxonogk.supabase.co",e,{auth:{autoRefreshToken:!1,persistSession:!1},global:{fetch:(e,t)=>fetch(e,{...t,cache:"no-store"})}})}},2390:(e,t,r)=>{r.d(t,{getPublicUrl:()=>i,uploadFile:()=>s});var a=r(65655);let o="primary-images";async function s(e,t,r="image/png"){let s=(0,a.i)(),{data:i,error:p}=await s.storage.from(o).upload(e,t,{contentType:r,upsert:!0});if(p)throw console.error(`[Storage] Upload failed for ${e}:`,p),p;return i}function i(e){let{data:t}=(0,a.i)().storage.from(o).getPublicUrl(e);return t.publicUrl}}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5972,9498],()=>r(47726));module.exports=a})();